# üè† –ü–∞—Ä—Å–µ—Ä Immobiliare.it

## –û–±–∑–æ—Ä

–ü–∞—Ä—Å–µ—Ä –¥–ª—è —Å–∞–π—Ç–∞ [Immobiliare.it](https://www.immobiliare.it) - –æ–¥–Ω–æ–≥–æ –∏–∑ –∫—Ä—É–ø–Ω–µ–π—à–∏—Ö –∏—Ç–∞–ª—å—è–Ω—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏. –ü–∞—Ä—Å–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –æ–±—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–∫ –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —Ç–∞–∫ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ScraperAPI –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### ‚úÖ –ß—Ç–æ —É–º–µ–µ—Ç –ø–∞—Ä—Å–µ—Ä

- **JSON-–ø–∞—Ä—Å–∏–Ω–≥**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `__NEXT_DATA__` –¥–ª—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- **–ì–∏–±–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø–æ–∏—Å–∫–∞
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É –ø—Ä–æ–µ–∫—Ç–∞
- **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–∞–π—Ç–∞
- **ScraperAPI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –û–±—Ö–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ rate limiting

### üéØ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã

```python
filters = {
    'city': 'roma',              # –ì–æ—Ä–æ–¥ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    'min_price': 800,            # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –≤ EUR
    'max_price': 1500,           # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –≤ EUR
    'min_rooms': 2,              # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç
    'max_rooms': 4,              # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç
    'min_area': 50,              # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥—å –≤ –º¬≤
    'max_area': 120,             # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥—å –≤ –º¬≤
    'property_type': 'apartment', # –¢–∏–ø –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
    'furnished': True            # –ú–µ–±–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è
}
```

### üèôÔ∏è –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≥–æ—Ä–æ–¥–∞

- Roma
- Milano
- Napoli
- Torino
- Firenze
- Bologna
- Venezia
- Bari
- Catania
- Palermo

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞

```python
from src.parsers.immobiliare_parser import ImmobiliareParser

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
parser = ImmobiliareParser()

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤
filters = {
    'city': 'roma',
    'min_price': 800,
    'max_price': 1500,
    'min_rooms': 2
}

# –ü–∞—Ä—Å–∏–Ω–≥
listings = parser.scrape_listings(
    filters=filters,
    max_pages=3,
    use_scraperapi=True
)

print(f"–ù–∞–π–¥–µ–Ω–æ {len(listings)} –æ–±—ä—è–≤–ª–µ–Ω–∏–π")
```

### 2. –ß–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å –ø–∞—Ä—Å–∏–Ω–≥–∞

```python
from src.services.scraping_service import ScrapingService

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞
service = ScrapingService()

# –ü–∞—Ä—Å–∏–Ω–≥ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
listings = service.scrape_single_source(
    source='immobiliare',
    filters={'city': 'roma'},
    max_pages=2
)

# –ü–∞—Ä—Å–∏–Ω–≥ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î
stats = service.scrape_and_save(
    filters={'city': 'milano', 'min_price': 1000},
    db=db_session,
    sources=['immobiliare'],
    max_pages=5
)
```

### 3. –ß–µ—Ä–µ–∑ API

```bash
# –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞—Ä—Å–µ—Ä–µ
GET /api/v1/scraping/parsers/immobiliare

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä—Å–µ—Ä
POST /api/v1/scraping/test
{
    "source": "immobiliare",
    "test_filters": {"city": "roma"}
}

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥
POST /api/v1/scraping/run
{
    "filters": {
        "city": "roma",
        "min_price": 800,
        "max_price": 1500
    },
    "sources": ["immobiliare"],
    "max_pages": 3,
    "use_scraperapi": true
}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –í—Ö–æ–¥—è—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã

```python
{
    "city": str,              # –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞
    "min_price": int,         # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
    "max_price": int,         # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
    "min_rooms": int,         # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç
    "max_rooms": int,         # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç
    "min_area": int,          # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥—å
    "max_area": int,          # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥—å
    "property_type": str,     # –¢–∏–ø –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
    "furnished": bool         # –ú–µ–±–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è
}
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞

```python
{
    "external_id": "12345678",
    "source": "immobiliare",
    "url": "https://www.immobiliare.it/annunci/...",
    "title": "Appartamento in affitto a Roma",
    "description": "Bellissimo appartamento...",
    "price": 1200.0,
    "price_currency": "EUR",
    "property_type": "apartment",
    "rooms": 3,
    "bathrooms": 2,
    "area": 85.0,
    "floor": "2",
    "city": "Roma",
    "district": "Centro Storico",
    "address": "Via del Corso, 123",
    "images": [
        "https://img.immobiliare.it/...",
        "https://img.immobiliare.it/..."
    ],
    "agency_name": "Agenzia Immobiliare Roma",
    "is_active": true,
    "scraped_at": null
}
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# ScraperAPI –∫–ª—é—á (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
SCRAPERAPI_KEY=your_scraperapi_key_here

# User Agent –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
USER_AGENT="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ –∫–æ–¥–µ

```python
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞
parser = ImmobiliareParser()

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
print(f"ScraperAPI: {'‚úÖ' if parser.scraperapi_key else '‚ùå'}")
print(f"–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≥–æ—Ä–æ–¥–∞: {parser.get_supported_cities()}")
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –ë–∞–∑–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
python test_immobiliare_parser.py

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ API
curl -X POST "http://localhost:8000/api/v1/scraping/test" \
     -H "Authorization: Bearer YOUR_TOKEN" \
     -H "Content-Type: application/json" \
     -d '{"source": "immobiliare"}'
```

### –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞

```
üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞ Immobiliare.it
==================================================
üìã –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã: {'city': 'roma', 'min_price': 800, 'max_price': 1500, 'min_rooms': 2}

üîó –¢–µ—Å—Ç 1: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ URL
   URL: https://www.immobiliare.it/affitto-case/roma/?prezzoMin=800&prezzoMax=1500&localiMin=2

‚úÖ –¢–µ—Å—Ç 2: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
   –û—á–∏—â–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã: {'city': 'roma', 'min_price': 800, 'max_price': 1500, 'min_rooms': 2}

üèôÔ∏è –¢–µ—Å—Ç 3: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≥–æ—Ä–æ–¥–∞
   –ì–æ—Ä–æ–¥–∞: ['roma', 'milano', 'napoli', 'torino', 'firenze', 'bologna', 'venezia', 'bari', 'catania', 'palermo']

üï∑Ô∏è –¢–µ—Å—Ç 4: –ü–∞—Ä—Å–∏–Ω–≥ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
   ‚úÖ –ù–∞–π–¥–µ–Ω–æ 20 –æ–±—ä—è–≤–ª–µ–Ω–∏–π

üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- **max_pages**: 3-5 –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞, 1-2 –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **use_scraperapi**: `true` –¥–ª—è production, `false` –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **–ó–∞–¥–µ—Ä–∂–∫–∏**: 2 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ (–≤—Å—Ç—Ä–æ–µ–Ω–æ)

### –õ–∏–º–∏—Ç—ã

- **ScraperAPI**: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–∞—à–µ–≥–æ –ø–ª–∞–Ω–∞
- **–ü—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã**: ~10-20 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- **–û–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ**: –æ–±—ã—á–Ω–æ 20-25

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

1. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ScraperAPI
2. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã**: –ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –ø—É—Ç–∏ –∫ –¥–∞–Ω–Ω—ã–º
3. **–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≥–æ—Ä–æ–¥–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
import logging

# –í–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logging.getLogger('src.parsers.immobiliare_parser').setLevel(logging.DEBUG)
```

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –≥–æ—Ä–æ–¥–∞

```python
# –í –∫–ª–∞—Å—Å–µ ImmobiliareParser
self.city_mapping = {
    'roma': 'roma',
    'your_city': 'your_city_slug',  # –î–æ–±–∞–≤–∏—Ç—å –∑–¥–µ—Å—å
    # ...
}
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞

1. –û–±–Ω–æ–≤–∏—Ç—å `build_search_url()` –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è URL
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ `validate_filters()`
3. –û–±–Ω–æ–≤–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –≤ `normalize_listing_data()`

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

–ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å:

```python
# –ü–∞—Ä—Å–∏–Ω–≥ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
stats = scraping_service.scrape_and_save(
    filters={'city': 'roma'},
    db=db_session,
    update_existing=True  # –û–±–Ω–æ–≤–ª—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
)

print(f"–°–æ–∑–¥–∞–Ω–æ: {stats['database_stats']['created']}")
print(f"–û–±–Ω–æ–≤–ª–µ–Ω–æ: {stats['database_stats']['updated']}")
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π
- –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞

### –õ–æ–≥–∏

–í—Å–µ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —É—Ä–æ–≤–Ω—è–º–∏:

- `INFO`: –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- `WARNING`: –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
- `ERROR`: –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
- `DEBUG`: –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –Ø–Ω–≤–∞—Ä—å 2025  
**–í–µ—Ä—Å–∏—è**: 1.0.0
