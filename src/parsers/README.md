# üè† –ü–∞—Ä—Å–µ—Ä—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ä—Å–µ—Ä—ã –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å —Å–∞–π—Ç–æ–≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
src/parsers/
‚îú‚îÄ‚îÄ __init__.py              # –≠–∫—Å–ø–æ—Ä—Ç –ø–∞—Ä—Å–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ base_parser.py           # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ immobiliare_scraper.py   # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å–∫—Ä–∞–ø–µ—Ä –¥–ª—è Immobiliare.it
‚îú‚îÄ‚îÄ run_scraping.py          # üöÄ –°–ö–†–ò–ü–¢ –î–õ–Ø –ó–ê–ü–£–°–ö–ê –ü–ê–†–°–ò–ù–ì–ê
‚îî‚îÄ‚îÄ README.md               # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞

**–ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞:**

```bash
# –° –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º (–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
python src/parsers/run_scraping.py

# –ë–µ–∑ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å)
python src/parsers/run_scraping.py --no-geo
```

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–∞—Ä—Å–µ—Ä

1. **üéØ –ü–∞—Ä—Å–∏—Ç**: `https://www.immobiliare.it/affitto-case/roma/`
2. **üìã –ò–∑–≤–ª–µ–∫–∞–µ—Ç**: –í–°–ï –æ–±—ä—è–≤–ª–µ–Ω–∏—è (–±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤)
3. **‚ö° –†–µ–∂–∏–º**: –ê–°–ò–ù–•–†–û–ù–ù–´–ô (–≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
4. **üì∏ –°–æ–±–∏—Ä–∞–µ—Ç**: –í–°–ï —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
5. **üó∫Ô∏è –ü–æ–ª—É—á–∞–µ—Ç**: –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ JSON –∏–ª–∏ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
6. **üíæ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç**: –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ PostgreSQL –±–∞–∑—É

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- ‚úÖ ScraperAPI –∫–ª—é—á –≤ `.env` —Ñ–∞–π–ª–µ
- ‚úÖ PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (`pip install -r requirements.txt`)

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### ImmobiliareScraper

- **–ú–µ—Ç–æ–¥**: `scrape_multiple_pages(max_pages=10)`
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è**: ScraperAPI Async API + Sync fallback
- **–†–µ–∂–∏–º**: ‚ö° **–ê–°–ò–ù–•–†–û–ù–ù–´–ô** (–≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
- **–î–∞–Ω–Ω—ã–µ**: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ `__NEXT_DATA__` JSON
- **–§–æ—Ç–æ**: –í—Å–µ —Ä–∞–∑–º–µ—Ä—ã (large, medium, small)
- **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ JSON + –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**:
  - –° –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º: ~4.65 –æ–±—ä—è–≤–ª–µ–Ω–∏–π/—Å–µ–∫
  - –ë–µ–∑ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è: ~4.83 –æ–±—ä—è–≤–ª–µ–Ω–∏–π/—Å–µ–∫
  - –°—Ä–µ–¥–Ω–µ–µ —Ñ–æ—Ç–æ –Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ: ~25 —à—Ç.
  - –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ external_id

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ

```python
from src.parsers.immobiliare_scraper import ImmobiliareScraper

# –°–æ–∑–¥–∞–µ–º —Å–∫—Ä–∞–ø–µ—Ä
scraper = ImmobiliareScraper(enable_geocoding=True)

# –ü–∞—Ä—Å–∏–º 5 —Å—Ç—Ä–∞–Ω–∏—Ü
listings = await scraper.scrape_multiple_pages(max_pages=5)

# –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
print(f"–ù–∞–π–¥–µ–Ω–æ: {len(listings)} –æ–±—ä—è–≤–ª–µ–Ω–∏–π")
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞

–ö–∞–∂–¥–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç:

```python
{
    'external_id': '123456789',
    'source': 'immobiliare',
    'title': 'Appartamento - 3 locali',
    'price': 1500,
    'property_type': 'apartment',  # –°–º. —Ç–∏–ø—ã –Ω–∏–∂–µ
    'rooms': 3,
    'area': 85,
    'address': 'Via del Corso, 123',
    'city': 'Roma',
    'latitude': 41.9028,
    'longitude': 12.4964,
    'images': [
        'https://pwm.im-cdn.it/image/123/large.jpg',
        'https://pwm.im-cdn.it/image/124/large.jpg',
        # ... –¥–æ 30+ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
    ],
    'url': 'https://www.immobiliare.it/annunci/123456789/',
    # ... –∏ –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}
```

### üè† –¢–∏–ø—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ (property_type)

–°–∫—Ä–∞–ø–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏:

| –¢–∏–ø         | –û–ø–∏—Å–∞–Ω–∏–µ                | –ò—Ç–∞–ª—å—è–Ω—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã          |
| ----------- | ----------------------- | ---------------------------- |
| `apartment` | –ö–≤–∞—Ä—Ç–∏—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) | Appartamento, Bilocale, etc. |
| `penthouse` | –ü–µ–Ω—Ç—Ö–∞—É—Å                | Attico, Superattico          |
| `house`     | –î–æ–º, –≤–∏–ª–ª–∞              | Villa, Casa, Villetta        |
| `studio`    | –°—Ç—É–¥–∏—è, –æ–¥–Ω–æ–∫–æ–º–Ω–∞—Ç–Ω–∞—è   | Monolocale, Studio           |
| `room`      | –ö–æ–º–Ω–∞—Ç–∞                 | Stanza, Camera, Posto letto  |

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**

- üè† –ö–≤–∞—Ä—Ç–∏—Ä—ã: ~92% (—Å–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π —Ç–∏–ø)
- üè¢ –ü–µ–Ω—Ç—Ö–∞—É—Å—ã: ~6% (–ø—Ä–µ–º–∏—É–º —Å–µ–≥–º–µ–Ω—Ç)
- üèòÔ∏è –î–æ–º–∞: ~2% (—á–∞—Å—Ç–Ω—ã–µ –¥–æ–º–∞ –∏ –≤–∏–ª–ª—ã)
- üè† –°—Ç—É–¥–∏–∏: —Ä–µ–¥–∫–æ –Ω–∞ –ø–µ—Ä–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö
- üö™ –ö–æ–º–Ω–∞—Ç—ã: –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–µ–∑–æ–Ω–∞

## üõ†Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API

–ü–∞—Ä—Å–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `ScrapingService`:

```python
from src.services.scraping_service import ScrapingService

service = ScrapingService()
result = await service.scrape_and_save(
    filters={"city": "roma"},
    db=db_session,
    max_pages=5
)
```

## üìù –õ–æ–≥–∏

–ü–∞—Ä—Å–µ—Ä —Å–æ–∑–¥–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:

- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- ‚ùå –û—à–∏–±–∫–∏ —Å –¥–µ—Ç–∞–ª—è–º–∏

## ‚ö° –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### üöÄ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç ScraperAPI Async Jobs API
- Fallback –Ω–∞ –æ–±—ã—á–Ω—ã–π ScraperAPI –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- –°–µ–º–∞—Ñ–æ—Ä –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ (–º–∞–∫—Å–∏–º—É–º 3 –∑–∞–ø—Ä–æ—Å–∞)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ external_id

### üó∫Ô∏è –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ

- –°–Ω–∞—á–∞–ª–∞ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ JSON
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç OpenStreetMap Nominatim API
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –ò—Ç–∞–ª–∏–∏

### üì∏ –ú–∞–∫—Å–∏–º—É–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π

- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã (large, medium, small)
- –í —Å—Ä–µ–¥–Ω–µ–º 25+ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ

### üõ°Ô∏è –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å

- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏
- Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
